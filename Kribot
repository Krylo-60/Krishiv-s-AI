<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>KriBot Ultra Pro 3.0</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
:root{
  --primary:#10a37f;--bg:#0b1220;--card:#ffffff;--text:#111827;--ai:#eef2f7;--user:#2563eb;
}
.dark{
  --bg:#020617;--card:#020617;--text:#e5e7eb;--ai:#1e293b;
}
*{box-sizing:border-box;margin:0;padding:0;}
body{font-family:Segoe UI,system-ui;background:var(--bg);color:var(--text);overflow-x:hidden;position:relative;}
.hidden{display:none;}
#bgCanvas{position:fixed;top:0;left:0;width:100%;height:100%;z-index:-1;}
.splash{height:100vh;display:flex;align-items:center;justify-content:center;flex-direction:column;}
.splash-card{background:var(--card);color:var(--text);padding:42px;border-radius:24px;text-align:center;max-width:420px;width:90%;box-shadow:0 30px 60px rgba(0,0,0,.4);transition: transform .3s ease;}
.splash-card:hover{transform: scale(1.03);}
.splash h1{margin:0;font-size:32px;}
.splash p{opacity:.8;margin:10px 0;}
.start{margin-top:20px;padding:14px 32px;border:none;border-radius:999px;background:var(--primary);color:white;font-size:16px;cursor:pointer;transition:.2s;}
.start:hover{transform:scale(1.05);}
.app{max-width:1100px;margin:24px auto;background:var(--card);border-radius:20px;box-shadow:0 30px 80px rgba(0,0,0,.35);overflow:hidden;}
header{background:linear-gradient(135deg,#0f766e,#10a37f);color:white;padding:16px 22px;font-size:22px;font-weight:700;display:flex;align-items:center;gap:10px;}
nav{display:flex;gap:8px;padding:12px;background:#e5e7eb;flex-wrap:wrap;}
nav button{background:white;border:1px solid #e5e7eb;border-radius:999px;padding:8px 16px;font-weight:600;cursor:pointer;transition:.2s;}
nav button:hover{background:var(--primary);color:white;box-shadow:0 8px 20px rgba(16,163,127,.4);}
.panel{padding:18px;}
.mode{margin-bottom:10px;}
.chat{height:400px;background:linear-gradient(#ffffff,#f9fafb);border-radius:18px;padding:18px;overflow-y:auto;box-shadow:inset 0 0 0 1px #e5e7eb,0 10px 30px rgba(0,0,0,.1);}
.msg{max-width:75%;padding:12px 14px;border-radius:18px;margin-bottom:10px;line-height:1.5;font-size:15px;white-space: pre-line;word-break: break-word;transition: all .3s ease;}
.user{background:linear-gradient(135deg,#2563eb,#1e40af);color:white;margin-left:auto;}
.ai{background:var(--ai);}
.typing{opacity:.7;font-style:italic;}
.typing::after{content:" ‚Ä¢‚Ä¢‚Ä¢";animation:blink 1.4s infinite;}
@keyframes blink{0%{opacity:.2}50%{opacity:1}100%{opacity:.2;}}
.footer{display:flex;gap:8px;background:white;padding:10px;border-radius:18px;margin-top:12px;box-shadow:0 12px 30px rgba(0,0,0,.2);}
input{flex:1;padding:12px;border-radius:12px;border:1px solid #d1d5db;font-size:15px;}
.send{background:var(--primary);color:white;border:none;border-radius:12px;padding:12px 18px;cursor:pointer;}
.voice{background:#ef4444;color:white;border:none;border-radius:12px;padding:12px;cursor:pointer;}
.clear{background:#f59e0b;color:white;border:none;border-radius:12px;padding:12px 18px;cursor:pointer;}
.grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(180px,1fr));gap:16px;}
.card{background:white;padding:18px;border-radius:16px;box-shadow:0 10px 30px rgba(0,0,0,.1);text-align:center;}
.cert{border:4px solid var(--primary);border-radius:20px;padding:32px;text-align:center;}
.badge{display:inline-block;background:gold;padding:6px 14px;border-radius:999px;margin:6px;font-weight:700;}
</style>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<canvas id="bgCanvas"></canvas>
<body>

<div id="splash" class="splash">
  <div class="splash-card">
    <h1>ü§ñ KriBot Ultra Pro</h1>
    <p>Created by <b>Krishiv</b><br>Grade 6 Student<br>Rastrothana Vidyakendra, Mangaluru</p>
    <input id="username" placeholder="Enter your name" style="padding:8px 12px; border-radius:8px; border:1px solid #d1d5db; margin-top:10px; width:80%;">
    <br>
    <button class="start" id="startBtn">üöÄ Start KriBot</button>
  </div>
</div>

<div id="app" class="app hidden">
<header>ü§ñ KriBot Ultra Pro</header>
<nav>
  <button onclick="show('chatP')">üí¨ Chat</button>
  <button onclick="show('statsP')">üìä Stats</button>
  <button onclick="show('certP')">üèÖ Certificate</button>
  <button onclick="show('aboutP')">‚ÑπÔ∏è About</button>
  <button onclick="toggleDark()">üåô</button>
</nav>

<div id="chatP" class="panel">
  <select id="mode" class="mode">
    <option>Normal</option>
    <option>Math Solver</option>
    <option>Homework Helper</option>
  </select>
  <div id="chat" class="chat"></div>
  <div class="footer">
    <input id="input" placeholder="Ask KriBot..." onkeydown="if(event.key==='Enter')ask()">
    <button class="voice" onclick="voice()">üé§</button>
    <button class="send" onclick="ask()">Send</button>
    <button class="clear" onclick="clearChat()">üßπ Clear</button>
  </div>
</div>

<div id="statsP" class="panel hidden">
<h3 id="statsTitle">üìä Usage Statistics</h3>
<div class="grid">
  <div class="card"><h2 id="uC">0</h2>User Messages</div>
  <div class="card"><h2 id="aC">0</h2>AI Replies</div>
  <div class="card"><h2 id="score">0</h2>Total Score</div>
</div>
</div>

<div id="certP" class="panel hidden">
  <div class="cert">
    <h2>Certificate of Achievement</h2>
    <h1 id="certName">User</h1>
    <p>has successfully explored</p>
    <h3>KriBot Ultra Pro</h3>
    <p>Created by <b>Krishiv (Grade 6)</b></p>
    <span class="badge">üèÜ AI Explorer</span>
    <br><br>
    <button onclick="window.print()">üñ®Ô∏è Print</button>
  </div>
</div>

<div id="aboutP" class="panel hidden">
  <h3>About This Project</h3>
  <p>KriBot Ultra Pro is a professional AI tutor <b>created by Krishiv</b>. Features:
    <ul>
      <li>Advanced Math Solver (fractions, powers, roots, algebra, quadratics, simultaneous equations)</li>
      <li>Step-by-step explanations with LaTeX</li>
      <li>Homework helper & word problem solver</li>
      <li>Friendly chat (responds to thanks, greetings, jokes, goodbyes)</li>
      <li>Voice input & clear chat</li>
      <li>Dark mode & stylish UI</li>
      <li>Persistent username & statistics tracking</li>
    </ul>
  </p>
</div>
</div>

<script>
// --- START BUTTON ---
document.getElementById('startBtn').addEventListener('click', start);

// --- PARTICLE BACKGROUND ---
const canvas=document.getElementById('bgCanvas'); const ctx=canvas.getContext('2d');
canvas.width=window.innerWidth; canvas.height=window.innerHeight;
let particles=[]; 
for(let i=0;i<150;i++) particles.push({x:Math.random()*canvas.width,y:Math.random()*canvas.height,r:Math.random()*2+1,s:Math.random()*0.5+0.2});
function animateParticles(){ctx.clearRect(0,0,canvas.width,canvas.height);particles.forEach(p=>{ctx.beginPath();ctx.arc(p.x,p.y,p.r,0,2*Math.PI);ctx.fillStyle='rgba(16,163,127,0.6)';ctx.fill();p.x+=p.s;p.y+=p.s;if(p.x>canvas.width)p.x=0;if(p.y>canvas.height)p.y=0;});requestAnimationFrame(animateParticles);}
animateParticles(); window.onresize=()=>{canvas.width=window.innerWidth;canvas.height=window.innerHeight;};

// --- DATA ---
let data=JSON.parse(localStorage.getItem("kribot"))||{chat:[],u:0,a:0,username:""};
let userName=data.username||"";
document.getElementById("username").value=userName;
const chat=document.getElementById("chat"),input=document.getElementById("input");
const splash=document.getElementById("splash"),app=document.getElementById("app");
const certName=document.getElementById("certName"),statsTitle=document.getElementById("statsTitle");

// --- FUNCTIONS ---
function start(){
  const uname=document.getElementById("username").value.trim();
  userName=uname||"User";
  certName.innerText=userName; statsTitle.innerText=`üìä Usage Statistics for ${userName}`;
  data.username=userName; save();
  splash.style.display="none"; app.classList.remove("hidden");
  if(data.chat.length===0) add(`üëã Hi ${userName}! I'm KriBot Ultra Pro.\nSelect a mode and start asking!`,"ai");
  else load(); input.focus();
}

function show(id){["chatP","statsP","certP","aboutP"].forEach(p=>document.getElementById(p).classList.add("hidden"));document.getElementById(id).classList.remove("hidden");}
function add(text,type){const d=document.createElement("div");d.className="msg "+type;d.innerHTML=text;chat.appendChild(d);chat.scrollTo({top:chat.scrollHeight,behavior:"smooth"});data.chat.push({text,type});save();MathJax.typesetPromise();}
function clearChat(){if(confirm("Are you sure you want to clear chat?")){chat.innerHTML="";data.chat=[];data.u=0;data.a=0;save();update();}}
function save(){localStorage.setItem("kribot",JSON.stringify(data));}
function load(){chat.innerHTML="";data.chat.forEach(m=>add(m.text,m.type));update();}
function update(){document.getElementById("uC").innerText=data.u;document.getElementById("aC").innerText=data.a;document.getElementById("score").innerText=data.u*2+data.a*3;save();}
function toggleDark(){document.body.classList.toggle("dark");}

// Voice input
function voice(){const SR=window.SpeechRecognition||window.webkitSpeechRecognition;if(!SR)return alert("Voice not supported");const r=new SR();r.start();r.onresult=e=>input.value=e.results[0][0].transcript;}

// --- ADVANCED MATH ---
function parseFraction(expr){try{return Function('return '+expr.replace(/\b(\d+)\/(\d+)\b/g,'($1/$2)'))();}catch{return null;}}
function mathTutor(expr){
  expr=expr.replace(/\s+/g,'').replace(/‚àö/g,'Math.sqrt').replace(/\^/g,'**');let steps='';
  try{
    if(expr.includes(';')){let lines=expr.split(';');if(lines.length===2){let parseEq=e=>{let m=/([+-]?\d*)x([+-]?\d*)y=([+-]?\d*)/.exec(e);return m?[parseFloat(m[1]||1),parseFloat(m[2]||1),parseFloat(m[3]||0)]:[0,0,0];};let [a1,b1,c1]=parseEq(lines[0]),[a2,b2,c2]=parseEq(lines[1]);let det=a1*b2-a2*b1;if(det===0)return{result:null,explanation:'No unique solution.'};let x=(c1*b2-c2*b1)/det,y=(a1*c2-a2*c1)/det;steps=`Solving: ${lines[0]}; ${lines[1]}<br>Det=${det}<br>x=${x}, y=${y}`;return{result:{x,y},explanation:steps};}}
    let quad=expr.match(/^([+-]?\d*\.?\d*)x\*\*2([+-]?\d*\.?\d*)x([+-]?\d*\.?\d*)=0$/);if(quad){let a=parseFloat(quad[1]||1),b=parseFloat(quad[2]||0),c=parseFloat(quad[3]||0);let D=b*b-4*a*c;let x1=(-b+Math.sqrt(D))/(2*a),x2=(-b-Math.sqrt(D))/(2*a);steps=`Quadratic: \[${expr.replace(/\*\*/g,'^')}\]<br>D=${D}<br>x1=${x1}, x2=${x2}`;return{result:[x1,x2],explanation:steps};}
    let val=parseFraction(expr);if(val!==null)steps=`Expression: \[${expr}\]<br>Result: ${val}`;else{let res=Function('return ('+expr+');')();steps=`Expression: \[${expr}\]<br>Result: ${res}`;}return{result:val,explanation:steps};
  }catch{return{result:null,explanation:'Invalid expression.'};}
}

// --- ASK ---
function ask(){
  const q=input.value.trim(); if(!q)return; add(q,'user'); data.u++; input.value='';
  const t=document.createElement('div'); t.className='msg ai typing'; t.innerText='KriBot is thinking'; chat.appendChild(t); chat.scrollTo({top:chat.scrollHeight,behavior:'smooth'});
  let r='',delay=800;
  if(mode.value==='Math Solver'){const math=mathTutor(q); r=math.explanation; delay=1000+q.length*50;}
  else if(mode.value==='Homework Helper'){r=`Let's think step by step:<br>${q}`; delay=1000+q.length*50;}
  else{const l=q.toLowerCase();
    if(/hi|hello|hey/.test(l)) r=`Hello ${userName}! üëã How can I help you today?`;
    else if(/how are you/.test(l)) r="I'm KriBot, always ready to help! üòÑ";
    else if(/joke/.test(l)) r="Why did the computer go to the doctor? It caught a virus! üòÜ";
    else if(/thank\s?you|thanks/.test(l)) r=`You're welcome, ${userName}! üòä`;
    else if(/bye|see you/.test(l)) r=`Goodbye ${userName}! üëã See you soon.`;
    else r=`You asked: ${q}\nThis is a smart demo AI response.`;}
  setTimeout(()=>{t.remove(); add(r,'ai'); data.a++; update();},delay);
}
</script>
</body>
</html>
